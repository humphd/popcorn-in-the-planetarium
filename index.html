<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="lib/jquery.js"></script>
    <script type="text/javascript" src="lib/jquery-ui.js"></script>
    <script type="text/javascript" src="lib/popcorn.js"></script>
    <script type="text/javascript" src="lib/popcorn.youtube.js"></script>
    <script type="text/javascript" src="lib/popcorn.footnote.js"></script>
    <script type="text/javascript" src="lib/popcorn.code.js"></script>
    <style>

      html, body {
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        overflow: hidden;
      }

      #div-khan-video {
        position: absolute;
        bottom: 0px;
        right: 0px;
        z-index: 5000;
        border: 2px solid #fff;
        border-radius: 15px;
        opacity: 0.5;
      }

      #iframe-planetarium {
        width: 100%;
        height: 100%;
      }

    </style>
    <script type="text/javascript">
      $(document).ready( function (e) {
        var $iframePlanetarium = $('#iframe-planetarium');
        var $divKhanVideo = $('#div-khan-video');

        function planetariumLoaded (event) {
          if (event.data === 'loaded') {
            var planets = {};
            var planetariumWin = $iframePlanetarium[0].contentWindow;
            planetariumWin.postMessage('start_demo', '*');
            window.removeEventListener('message', planetariumLoaded, false);

            var $planetLinks = $iframePlanetarium.contents().find('li.planet');
            for (var i=0; i<$planetLinks.length; ++i) {
              var li = $planetLinks[i];
              planets[li.id] = li;
            } //for

            var popcorn = Popcorn( Popcorn.youtube('div-khan-video') );

            popcorn.code({
              start: 89,
              end: 90,
              onStart: function (options) {
                $(planets['mercury']).click();
              },
            })

            .code({
              start: 98,
              end: 99,
              onStart: function (options) {
                $(planets['venus']).click();
              },
            })

            .code({
              start: 118,
              end: 119,
              onStart: function (options) {
                $(planets['mars']).click();
              },
            })

            .code({
              start: 121,
              end: 122,
              onStart: function (options) {
                $(planets['jupiter']).click();
              },
            })

            .code({
              start: 160,
              end: 161,
              onStart: function (options) {
                $(planets['saturn']).click();
              },
            })

            .code({
              start: 222,
              end: 223,
              onStart: function (options) {
                $(planets['uranus']).click();
              },
            })

            .code({
              start: 232,
              end: 232,
              onStart: function (options) {
                $(planets['neptune']).click();
              },
            })


          } //if

        } //planetariumLoaded

        window.addEventListener('message', planetariumLoaded, false);

      }); //ready block
    </script>
  </head>
  <body>
    <iframe id="iframe-planetarium" width="100%" height="100%" src="planetarium/demo.html" frameborder="0"></iframe>
    <div id="div-khan-video" src="http://www.youtube.com/watch?v=GP53b__h4ew"></div>
  </body>
</html>
